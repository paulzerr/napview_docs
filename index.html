<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAPVIEW manual</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <main class="content">
        <section id="introduction" class="intro-hero">
            <div class="intro-container">
                <div class="intro-logo">
                    <img src="logo.png" alt="NAPVIEW Logo" class="logo">
                </div>
                <div class="intro-lead">
                    <h1>sleep stage visualizer for real-time EEG sleep experiments</h1>
                    <a href="https://github.com/paulzerr/napview" class="intro-link">https://github.com/paulzerr/napview</a>
                </div>
                <div class="intro-copy">
                    <ul class="intro-points">
                        <li>automated near-real-time sleep stage classification on live EEG data</li>
                        <li>visualization interface for deep learning autoscoring</li>
                        <li>displays sleep stage probabilities, and other signal features</li>
                        <li>supports BrainVision and OpenBCI natively, plus any labstreaminglayer-compatible EEG system with real-time signal streaming capabilities</li>
                        <li>is the night shift experimenter's friend</li>
                    </ul>

                    <div class="hero-cta-row">
                        <div class="hero-download">
                            <p class="download-cta"><strong><a href="https://github.com/paulzerr/napview/releases/latest/download/NAPVIEW_installer.exe">Download NAPVIEW v0.1.1 (Windows)</a></strong></p>
                            <p class="download-note"><a href="#install-with-pip">On Linux and MacOS, install the Python package.</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="installation">
            <nav class="section-jump-nav section-jump-nav--installation" aria-label="Page sections">
                <ul>
                    <li><a href="#gui-walkthrough">How to use</a></li>
                    <li><a href="#faq">FAQ & troubleshooting</a></li>
                    <li><a href="#how-to-cite">How to cite</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
            <h2>Installation</h2>
            <h3>Option 1: <a class="install-download-link" href="https://github.com/paulzerr/napview/releases/latest/download/NAPVIEW_installer.exe">Download NAPVIEW installer (Windows)</a></h3>
            <p>The easiest way to use napview on Windows is to download the portable self-extracting installer.</p>
            <p><strong>Note:</strong> due to the restrictive environment of Windows, you may see a "Search on app store" popup window. Click "No". You may also see the blue Smartscreen warning. In that case click "More info" and then "run anyway". You can also right-click <code>NAPVIEW.exe</code>, go to Properties and tick the box "Unblock". Should this fail, try installing via the standalone archive or pip (see below).</p>
            <br>
            <h3>Option 2: <a class="install-download-link" href="https://github.com/paulzerr/napview/releases/latest/download/NAPVIEW_standalone.zip">Download NAPVIEW standalone (Windows)</a></h3>
            <p><a class="install-download-link" href="https://github.com/paulzerr/napview/releases/latest/download/NAPVIEW_standalone.zip">Download</a> the zip file, extract it to your preferred location, then double click <code>run_napview.bat</code>. This installation method can be useful on systems without admin priviledges.</p>
            <br>

            <h3 id="install-with-pip">Option 3: Install as Python package</h3>
            <p>First install e.g., <a href="https://www.anaconda.com/download/success">Miniconda</a> (an easy way to manage Python environments),
            and create a new environment.
            
            </p>
            
            <p><strong>Windows:</strong></p>
            <pre><code>conda create -n napview-env python=3.11 -y
conda activate napview-env</code></pre>
            <p><strong>macOS/Linux:</strong></p>
            <pre><code>conda create -n napview-env python=3.11 -y
conda activate napview-env</code></pre><br>
            <p><strong>Install NAPVIEW:</strong></p>
            <pre><code>pip install napview</code></pre>

            <br>
            <p><strong>Launch NAPVIEW:</strong></p>
            <pre><code>conda activate napview-env<br>napview</code></pre>
            <p><strong><br>Note:</strong> on first run, NAPVIEW may download model weight files via the NIDRA backend.</p>
            <br>



        </section>

        <section id="gui-walkthrough">
            <h2>Graphical user interface (GUI) walkthrough</h2>
            <img src="gui.png" alt="NAPVIEW graphical user interface" class="section-screenshot">

            <h3>Step 1: Start NAPVIEW</h3>
            <p>Start <code>NAPVIEW.exe</code> or <code>NAPVIEW.bat</code>, or enter <code>napview</code> in a terminal. A browser tab should open (default url <code>127.0.0.1:8145</code>) containing the napview control panel.</p>

            <h3>Step 2: Select data source</h3>
            <ul>
                <li><strong>Play back a sleep recording (simulator):</strong> use the integrated example recording or select a local EDF file to simulate a live stream. The file is copied into the session data directory.</li>
                <li><strong>BrainVision:</strong> first enable RDA in BrainVision Recorder, connect EEG amp, and begin monitoring. Next, enter the IP and RDA port of the EEG acquisition PC. On Windows you can find the IP by opening a command prompt (CTRL+R, then type <code>cmd</code>, press Enter. Next, type <code>ipconfig</code>, press Enter, and look for an entry under “Ethernet adapter” (or “Wireless LAN adapter Wi-Fi” if using Wi-Fi) labeled “IPv4 Address.” The number shown next to IPv4 Address is the IP address of the EEG acquisition PC. If you run NAPVIEW on the EEG acquisition PC, the IP is usually <code>127.0.0.1:8145</code> The port is typically <code>51234</code>.</li>
                <li><strong>OpenBCI:</strong> choose a board type and port (if required). Use Synthetic to test without hardware.</li>
                <li><strong>Custom LSL stream:</strong> provide the name of the LSL stream (by default napview assumes <code>napview_EEG_stream</code>).</li>

            </ul>

            <h3>Step 3: Optional channel configuration</h3>
            <ul>
                <li>Select EEG channels to use. This is optional, as NAPVIEW will automatically detect channel type and will skip noisy or empty channels. During scoring all combinations between valid EEG and EOG channels are being used and scored individually. The final score is then determined by majority vote.</li>
            </ul>

            <h3>Step 4: Start streaming</h3>
            <p>Click <strong>START napview</strong>. A new tab opens with the real-time visualizer (typically at <code>http://127.0.0.1:8245</code>). Sleep stage probabilities stabilize after several minutes of data. Less than 5 minutes of data will likely not result in reliable estimates. A maximum of 15 minutes of past data will be used.</p>

            <h3>Step 5: Shutdown and save</h3>
            <p>Once the experiment session is finished, click <strong>SHUTDOWN and save</strong> to stop the session and write outputs.</p>
        </section>

        <section id="preparing-data">
            <h2>Notes</h2>
            <ul>
                <li>NAPVIEW expects a continuous EEG stream with channel names available from the stream metadata.</li>
                <li>Use the Simulator to test the system with a static EDF file.</li>
                <li>For BrainVision, make sure the RDA plugin is enabled and configured correctly.</li>
                <li>For custom LSL streams, make sure the stream type is EEG and the name matches the value in the GUI.</li>
                <li>It is recommended that you test the system first with the Simulator, then with an EEG amp connected without a participant, and finally with an awake participant. If everything works as expected you are now prepared to use NAPVIEW during an overnight session.</li>
<li>
            <p>NAPVIEW uses the NIDRA backend for real-time scoring. The default staging model is U-Sleep, which has been validated in large multi-center datasets. For detailed performance metrics, refer to the original U-Sleep publication:</p>
            <p><a href="https://www.nature.com/articles/s41746-021-00440-5">U-Sleep: resilient high-frequency sleep staging (Perslev et al., 2021)</a></p>
</li>
            </ul>
        </section>



        <section id="faq">
            <h2>FAQ & troubleshooting</h2>
            <h3>GUI issues</h3>
            <p><strong>Q: The GUI did not open.</strong><br>
            A: Check the terminal output or for the correct URL (normally <code>http://127.0.0.1:8145</code>) and enter it manually in the browser. Otherwise check the logs, which should be in your user directory, e.g. <code>C:\Users\<your-username>\AppData\Local\napview\data</code> </p>
            <p><strong>Q: The visualizer tab is empty or only shows a text message.</strong><br>
            A: This usually means the data stream has not started or there is no incoming data. Confirm the data source and check the status panel for red warnings. Otherwise check the logs.</p>

            <p><strong>Q: My BrainVision EEG amp does not connect.</strong><br>
            A: Verify the RDA plugin is enabled and the IP/port are correct.</p>
            <p><strong>Q: Custom LSL stream not found.</strong><br>
            A: Ensure the stream is running, the stream name matches exactly, and the stream type is EEG.</p>

        </section>

        <section id="how-to-cite">
            <h2>How to cite NAPVIEW</h2>
            <p>If you use NAPVIEW in your research, please cite the NAPVIEW repository and the underlying models.</p>
            <h3>1. Citing NAPVIEW</h3>
            <pre>
Zerr, P. (2025). napview: real-time sleep scoring and analysis visualizer. GitHub. https://github.com/paulzerr/napview
</pre>
            <h3>2. Citing U-Sleep</h3>
            <pre>
Perslev, M., et al. (2021). U-Sleep: resilient high-frequency sleep staging. NPJ Digital Medicine.
</pre>
        </section>

        <section id="license">
            <h2>License</h2>
            <p>This project is released under the BSD-3 Clause License.</p>
        </section>

        <section id="contact">
            <h2>Contact</h2>
            <p>For questions, bug reports, or feedback, please contact Paul Zerr at <a href="mailto:paul.zerr@donders.ru.nl">paul.zerr@donders.ru.nl</a>.</p>
        </section>
    </main>
</body>
</html>
